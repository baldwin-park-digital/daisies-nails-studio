---
interface Props {
  title: string;
  description: string;
  href?: string;
  external?: boolean;
  image?: { src: string; width: number; height: number } | string;
  badge?: string;
}

const {
  title,
  description,
  href,
  external = false,
  image,
  badge,
} = Astro.props;

const Component = href ? "a" : "div";
const containerClass = image
  ? "relative overflow-hidden rounded-lg border border-primary/20 hover:border-primary/40 group hover:shadow-lg transition-all"
  : "relative card";
const attrs = href
  ? {
      href,
      target: external ? "_blank" : undefined,
      rel: external ? "noopener noreferrer" : undefined,
      class:
        containerClass +
        (image
          ? ""
          : " group hover:shadow-lg transition-shadow hover:border-primary/40"),
    }
  : {
      class:
        containerClass +
        (image
          ? ""
          : " group hover:shadow-lg transition-shadow hover:border-primary/40"),
    };
---

<Component {...attrs}>
  {
    badge && (
      <span class="absolute top-4 left-4 px-3 py-1 text-xs font-semibold text-on-primary bg-primary rounded-full z-10">
        {badge}
      </span>
    )
  }

  {
    image &&
      (typeof image === "string" ? (
        <img src={image} alt={title} class="w-full h-40 object-fill" />
      ) : (
        <img
          src={image.src}
          width={image.width}
          height={image.height}
          alt={title}
          class="w-full h-40 object-fill"
          loading="lazy"
        />
      ))
  }

  <div class={`${badge && "pt-12"} ${image && "p-3"} p-6`}>
    <h3 class="text-xl font-bold text-primary mb-3 mt-0">
      {title}
    </h3>

    <p class="text-on-surface-dim leading-relaxed m-0">
      {description}
    </p>

    {
      href && (
        <div class="text-primary font-medium mt-4">
          <span aria-label={`Learn more about ${title}`}>
            Learn more â†’
          </span>
        </div>
      )
    }
  </div>
</Component>
